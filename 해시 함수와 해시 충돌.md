# 00_해시 함수와 해시 충돌

## 1. 해시 함수

> Hash Function

데이터를 효율적으로 관리하기 위해 **임의의 길이의 데이터를 수학적 연산을 통해 고정된 길이의 데이터로 맵핑하는 함수**이다.

DB에 데이터를 넣거나, 데이터의 무결성을 검사하기 위해 주로 사용한다.

- 간단한 해시 함수 예시

```java
public class HashFunction {
    
    private static final int MAX_TABLE = 1000;
    
    public static int hash(String str) {
        int hash = 5381;
        for (int i = 0; i < str.length(); i++) {
            char c = str.charAt(i);
            hash = ((hash << 5) + hash + c) % MAX_TABLE;
        }
        return hash % MAX_TABLE;
    }
    
}
```

<br>

## 2. 해시 충돌

> Hash Collision

### 1. 해시 테이블

Key와 Value를 맵핑해둔 자료 구조로, 해시 함수로 얻은 Key값을 활용하여 인덱스로 사용하고 해당 인덱스에 데이터를 저장하여 효율적인 데이터 검색을 가능하게 한다.

해시 맵(Hash Map)이라고도 한다.

<br>

### 2. 해시 충돌

해시 함수가 어떤 상황에서라도 완벽하다면 아무 문제 없겠지만 실제로는 그렇지 않다.

왜냐하면 해시 함수에 들어오는 입력 값은 무한하지만, 출력으로 나오는 값은 유한하기 때문에 `비둘기 집의 원리`에 의해서 해시 충돌은 `반드시 발생`한다.

따라서 해시 함수를 잘 정의하는 것이 핵심이며, 해시 충돌을 최소화하여 성능을 개선하는데 도움이 된다.

#### (1) 체이닝(Chaining)

버킷 내에 연결 리스트(LinkedList)를 할당하고, 버킷에 데이터를 삽입하다가 해시 충돌이 발생하면 연결 리스트로 데이터를 연결하는 방식이다.

C++, Java에서 채택한 해시 충돌 해결 방법이다.

![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/94a10e47-9cd7-4aec-ae8e-e390d8cc7d13)

<br>

#### (2) 개방 주소법(Open Addressing, 오픈 어드레싱)

버킷에 데이터를 삽입하다가, 해시 충돌이 발생하면 해시 함수로 얻은 인덱스가 아닌 다른 주소 공간에 해당 데이터를 삽입하는 방식이다.

Python의 경우 오픈 어드레싱을 해시 충돌 해결 방법으로 채택했다.

![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/9bd0ecd4-9b04-4639-8c37-2b9991ff58d4)

오픈 어드레싱의 경우 3가지 대표적인 방법이 존재한다.

- 선형 탐색: 해시 충돌 시 다음 버켓 혹은 여러 버켓을 건너뛴 다음 데이터를 삽입한다.
- 제곱 탐색: 해시 충돌 시 제곱수만큼 건너뛴 버켓에 데이터를 삽입한다.
- 이중 해시: 2개의 해싱 함수를 운용하여 해시 충돌 시 다른 해시 함수를 한 번 더 적용한 결과를 이용한다.
  - 예) 문자열을 해싱할 때, 문자열의 개수는 26개이기 때문에 26보다 크면서 가까운 소수 2개를 선정하여 해싱한다. (29, 31)


<br>

### 3. 성능 비교

체이닝 방식의 경우 연결 리스트만 사용하면 되기 때문에 복잡한 계산식을 사용할 필요가 없다. 그러나 데이터가 커질 수록 성능 저하는 Linear하게 발생한다.

반면에 오픈 어드레싱은 삽입/삭제 시 오버헤드가 적다는 장점이 있지만, 이중 해시의 경우 다른 해싱함수를 어떻게 할 것인지, 버킷을 얼마나 건너뛸 것인지 등을 고려해야 해서 복잡하고, 저장할 데이터가 많으면 성능은 급격하게 나빠진다. 따라서 저장할 데이터가 적을 때 유리하다.

![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/c0f38f0f-ac2d-4262-8e25-6f4f1234b439)