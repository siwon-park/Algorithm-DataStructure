# BFS (너비 우선 탐색)

BFS 탐색

## 1. BFS 전제 조건

> 모든 간선의 가중치가 동일해야 한다

BFS에도 전제 조건이 있다. `"모든 간선이 동일한 가중치를 가져야 한다"`이다.

만약에 간선의 가중치가 천차만별이면 어떻게 될까?

최단 거리를 구한다고 했을 때, 거리가 갱신될 때마다 큐에 원소를 넣게 되고 경우에 따라서는 같은 위치를 중복 방문하게 되어 비효율적일 수 밖에 없다.

최악의 경우에는 `O(비용의 최댓값 x 정점의 개수)`의 시간 복잡도를 가지게 된다.

따라서 만약에 간선의 가중치가 다양하다면, BFS보다는 다익스트라 알고리즘으로 접근하는 것이 올바른 접근법이라고 할 수 있다.

<br>

## 2. BFS 탐색 팁 및 유용한 스킬

### 1) 8방향 탐색

BFS 탐색 시, 주변을 탐색하기 위해 `dy`, `dx`라는 배열을 이용해서 원하는 방향으로 탐색하곤 한다.

4방향 탐색 시에는 간단하지만, 8방향 탐색 시에는 배열에 값을 잘못 지정하는 실수를 범할 가능성이 높다.

이 때, 굳이 8방향으로 지정하지 않고 2중 for문을 통해서 8방향 범위를 탐색하는 방법도 존재한다.

|                    크기가 8인 배열을 이용                    |                       2중 for문을 이용                       |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| ![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/076dbac1-a69b-4741-b6e7-fcaae996b39f) | ![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/cb433c4f-4d2c-466b-909e-d0b2a41d2e74) |

이렇게 되는 이유는 생각보다 엄청 간단한데, 바로 탐색의 범위의 시작과 끝이 기준점의 좌측 대각, 우측 대각이기 때문이다.

<img src="https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/008bf92d-12ff-4d52-b0cf-5aeba5f10bad" referrerpolicy="no-referrer" alt="image" width="250px">

2중 for문을 이용해서 8방향 탐색 시, 범위를 벗어나는 것도 체크하기 쉽다.

크기가 8인 배열을 이용해서 8방향을 탐색한다면, 루프마다 8번씩 체크해야 하지만, 2중 for문을 사용할 경우 미리 범위를 지정해서 처음에 한 번만 체크하고 넘어가면 된다.

| 크키가 8인 배열 이용 시 범위 체크                            | 2중 for문 이용 시 범위 체크                                  | 2중 for문 이용 시 범위 체크                                  |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/4b5c1d4b-1a4b-47ce-9320-d5923b12cc30) | ![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/d2a3c294-b70c-4fd8-91ff-87801cd0f000) | ![image](https://github.com/siwon-park/Algorithm-DataStructure/assets/93081720/744a33ad-4d8c-46e5-a31f-199f3046b56f) |

<br>

## 3. BFS 문제 CASE

> BFS 문제 풀이 시 팁 서술 (각 케이스별로 나눠서 서술)

### CASE 1

2차원의 배열 그 이상을 선언해야 하는 경우

BFS 탐색을 하면서 특정 행동을 해서 해당 위치로 갔는지, 특정 행동을 하지 않고 갔는지 나뉘는 경우

- 예) 벽을 최대 n번까지 부수면서 목적지까지 갈 수 있을 때 갈 수 있는지 유무나 최단 거리 등을 구하는 경우
  - 3차원의 배열을 선언해서 벽을 몇 번 부셨는지 체크

#### 관련 문제

[벽 부수고 이동하기](https://www.acmicpc.net/problem/2206)

[벽 부수고 이동하기 2](https://www.acmicpc.net/problem/14442)

[공주님을 구해라!](https://www.acmicpc.net/problem/17836)

---

### CASE 2

비트마스킹 + BFS

넓은 범위에서 보면 CASE 1과 비슷할 수도 있음

BFS 탐색인 것 같은데 방문에 순서가 필요하다거나 특정 행동을 하고 나서 방문했던 곳을 재방문하여 분기가 나뉘는 경우

- 예) 모든 물건을 갖고 돌아오는 최단 거리를 구하는 경우
  - 어떤 물건을 먼저 가져가느냐에 따라 최단 거리가 달라짐

#### 관련 문제

[아맞다우산](https://www.acmicpc.net/problem/17244)

[달이 차오른다, 가자](https://www.acmicpc.net/problem/1194)

[보석 줍기](https://www.acmicpc.net/problem/2001)

---

### CASE 3

0 - 1 BFS

0 - 1 BFS는 다음 위치로 이동하는 데 비용이 0이라면 큐의 앞에, 아니라면 큐의 뒤에 삽입하면서 탐색하는 BFS 방식임

사실 0 - 1 BFS는 다익스트라 알고리즘을 최적화한 형태의 BFS 탐색 (같은 종류라는 의미는 아님)

그런데 대놓고 0 - 1 BFS다라고 나오는 경우는 드묾

그럼 어떻게 나오는가? 특정 행동을 했을 때 다른 곳으로 가는데 필요한 비용이 0이 되는 경우

- 예1) 일반적인 이동은 이동에 필요한 비용이 1인데, 최대 한 번까지만 행 또는 열에 대해 자유롭게 이동이 가능할 경우
- 예2) 왼쪽에서 오른쪽으로 가는 경우에만 비용이 0이고, 나머지 방향으로 가는데에는 비용이 1드는 경우

#### 관련 문제

[보물 찾기 2](https://www.acmicpc.net/problem/27978)

[바리스타의 힘](https://www.acmicpc.net/problem/24439)

---

### CASE 4

방문 배열을 특이하게 사용해야 하는 경우

방문 배열을 따로 나눠서 두고 문제를 해결해야 하는 경우가 있다.

보통 이런 경우 탐색 도중 특정 행동을 해야 하거나, 특정 행동을 했을 때 특수한 혜택이 주어지는데 일반 BFS 탐색을 하게 되면 너무 많은 경우의 수를 탐색해야 해서 일반 BFS 푸는 것이 불가능한 경우

#### 관련 문제

[시니컬한 개구리](https://www.acmicpc.net/problem/25189)

---

### CASE 5

큐를 2개 이상 운용해야 하는 경우 (경우에 따라 하나는 우선 순위 큐일 수도 있음)

주로 구현 문제에서 큐를 2개 운용해야 하는 경우가 자주 나온다.

- 예1) 현재 작업을 처리하는 큐와 다음에 사용할 큐로 나뉘는 경우
  - 이번 회차에 사용할 큐가 있고, 다음에 사용할 것들을 이번 회차의 큐에 삽입하는 것이 아니라 다음 회차에 사용할 큐에 넣어서 사용하는 경우
- 예2) 작업을 지속적으로 처리하는 큐와 특정 조건을 만족했을 때 대기 중인 큐에서 뽑아와야 하는 경우 등

또는 비트 마스킹으로 처리하기에는 사용해야할 비트 수가 너무 많아서 탐색해야할 경우의 수가 너무 많아 지는 경우 큐를 2개 운용하여 문제를 해결할 수도 있다.

#### 관련 문제

[열쇠](https://www.acmicpc.net/problem/9328)

[Gaaaaaaaaaarden](https://www.acmicpc.net/problem/18809)